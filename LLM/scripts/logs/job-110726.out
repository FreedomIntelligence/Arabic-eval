[2023-09-11 22:29:09,721] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[22:29:14] WARNING  The following values were not passed to `accelerate launch` and had defaults used instead:   launch.py:890
                            `--num_processes` was set to a value of `1`                                                       
                            `--num_machines` was set to a value of `1`                                                        
                            `--mixed_precision` was set to a value of `'no'`                                                  
                            `--dynamo_backend` was set to a value of `'no'`                                                   
                    To avoid this warning pass in values for each of the problematic parameters or run                        
                    `accelerate config`.                                                                                      
[2023-09-11 22:29:16,791] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Using pad_token, but it is not set yet.
daily life:   0%|                                                                                    | 0/337 [00:00<?, ?it/s]daily life:   0%|▏                                                                           | 1/337 [00:02<15:13,  2.72s/it]daily life:   1%|▍                                                                           | 2/337 [00:03<10:12,  1.83s/it]daily life:   1%|▋                                                                           | 3/337 [00:05<08:35,  1.54s/it]daily life:   1%|▉                                                                           | 4/337 [00:06<07:49,  1.41s/it]daily life:   1%|█▏                                                                          | 5/337 [00:07<07:23,  1.34s/it]daily life:   2%|█▎                                                                          | 6/337 [00:08<07:08,  1.29s/it]daily life:   2%|█▌                                                                          | 7/337 [00:09<06:56,  1.26s/it]daily life:   2%|█▊                                                                          | 8/337 [00:11<06:50,  1.25s/it]daily life:   3%|██                                                                          | 9/337 [00:12<06:45,  1.24s/it]daily life:   3%|██▏                                                                        | 10/337 [00:13<06:40,  1.23s/it]daily life:   3%|██▍                                                                        | 11/337 [00:14<06:37,  1.22s/it]daily life:   4%|██▋                                                                        | 12/337 [00:15<06:34,  1.21s/it]daily life:   4%|██▉                                                                        | 13/337 [00:17<06:32,  1.21s/it]daily life:   4%|███                                                                        | 14/337 [00:18<06:31,  1.21s/it]daily life:   4%|███▎                                                                       | 15/337 [00:19<06:30,  1.21s/it]daily life:   5%|███▌                                                                       | 16/337 [00:20<06:28,  1.21s/it]daily life:   5%|███▊                                                                       | 17/337 [00:22<06:25,  1.21s/it]daily life:   5%|████                                                                       | 18/337 [00:23<06:24,  1.21s/it]daily life:   6%|████▏                                                                      | 19/337 [00:24<06:24,  1.21s/it]daily life:   6%|████▍                                                                      | 20/337 [00:25<06:22,  1.21s/it]daily life:   6%|████▋                                                                      | 21/337 [00:26<06:21,  1.21s/it]daily life:   7%|████▉                                                                      | 22/337 [00:28<06:20,  1.21s/it]daily life:   7%|█████                                                                      | 23/337 [00:29<06:19,  1.21s/it]daily life:   7%|█████▎                                                                     | 24/337 [00:30<06:18,  1.21s/it]daily life:   7%|█████▌                                                                     | 25/337 [00:31<06:17,  1.21s/it]daily life:   8%|█████▊                                                                     | 26/337 [00:32<06:16,  1.21s/it]daily life:   8%|██████                                                                     | 27/337 [00:34<06:13,  1.21s/it]daily life:   8%|██████▏                                                                    | 28/337 [00:35<06:12,  1.21s/it]daily life:   9%|██████▍                                                                    | 29/337 [00:36<06:12,  1.21s/it]daily life:   9%|██████▋                                                                    | 30/337 [00:37<06:11,  1.21s/it]daily life:   9%|██████▉                                                                    | 31/337 [00:38<06:09,  1.21s/it]daily life:   9%|███████                                                                    | 32/337 [00:40<06:08,  1.21s/it]daily life:  10%|███████▎                                                                   | 33/337 [00:41<06:07,  1.21s/it]daily life:  10%|███████▌                                                                   | 34/337 [00:42<06:05,  1.21s/it]daily life:  10%|███████▊                                                                   | 35/337 [00:43<06:04,  1.21s/it]daily life:  11%|████████                                                                   | 36/337 [00:44<06:04,  1.21s/it]daily life:  11%|████████▏                                                                  | 37/337 [00:46<06:02,  1.21s/it]daily life:  11%|████████▍                                                                  | 38/337 [00:47<06:00,  1.20s/it]daily life:  12%|████████▋                                                                  | 39/337 [00:48<05:58,  1.20s/it]daily life:  12%|████████▉                                                                  | 40/337 [00:49<05:58,  1.21s/it]daily life:  12%|█████████                                                                  | 41/337 [00:51<05:56,  1.21s/it]daily life:  12%|█████████▎                                                                 | 42/337 [00:52<05:55,  1.20s/it]daily life:  13%|█████████▌                                                                 | 43/337 [00:53<05:53,  1.20s/it]daily life:  13%|█████████▊                                                                 | 44/337 [00:54<05:53,  1.21s/it]daily life:  13%|██████████                                                                 | 45/337 [00:55<05:52,  1.21s/it]daily life:  14%|██████████▏                                                                | 46/337 [00:57<05:50,  1.21s/it]daily life:  14%|██████████▍                                                                | 47/337 [00:58<05:50,  1.21s/it]daily life:  14%|██████████▋                                                                | 48/337 [00:59<05:48,  1.21s/it]daily life:  15%|██████████▉                                                                | 49/337 [01:00<05:47,  1.21s/it]daily life:  15%|███████████▏                                                               | 50/337 [01:01<05:46,  1.21s/it]daily life:  15%|███████████▎                                                               | 51/337 [01:03<05:46,  1.21s/it]daily life:  15%|███████████▌                                                               | 52/337 [01:04<05:44,  1.21s/it]daily life:  16%|███████████▊                                                               | 53/337 [01:05<05:43,  1.21s/it]daily life:  16%|████████████                                                               | 54/337 [01:06<05:42,  1.21s/it]daily life:  16%|████████████▏                                                              | 55/337 [01:07<05:41,  1.21s/it]daily life:  17%|████████████▍                                                              | 56/337 [01:09<05:40,  1.21s/it]daily life:  17%|████████████▋                                                              | 57/337 [01:10<05:39,  1.21s/it]daily life:  17%|████████████▉                                                              | 58/337 [01:11<05:37,  1.21s/it]daily life:  18%|█████████████▏                                                             | 59/337 [01:12<05:36,  1.21s/it]daily life:  18%|█████████████▎                                                             | 60/337 [01:13<05:35,  1.21s/it]daily life:  18%|█████████████▌                                                             | 61/337 [01:15<05:33,  1.21s/it]daily life:  18%|█████████████▊                                                             | 62/337 [01:16<05:32,  1.21s/it]daily life:  19%|██████████████                                                             | 63/337 [01:17<05:31,  1.21s/it]daily life:  19%|██████████████▏                                                            | 64/337 [01:18<05:29,  1.21s/it]daily life:  19%|██████████████▍                                                            | 65/337 [01:20<05:28,  1.21s/it]daily life:  20%|██████████████▋                                                            | 66/337 [01:21<05:27,  1.21s/it]daily life:  20%|██████████████▉                                                            | 67/337 [01:22<05:27,  1.21s/it]daily life:  20%|███████████████▏                                                           | 68/337 [01:23<05:25,  1.21s/it]daily life:  20%|███████████████▎                                                           | 69/337 [01:24<05:23,  1.21s/it]daily life:  21%|███████████████▌                                                           | 70/337 [01:26<05:22,  1.21s/it]daily life:  21%|███████████████▊                                                           | 71/337 [01:27<05:22,  1.21s/it]daily life:  21%|████████████████                                                           | 72/337 [01:28<05:20,  1.21s/it]daily life:  22%|████████████████▏                                                          | 73/337 [01:29<05:19,  1.21s/it]daily life:  22%|████████████████▍                                                          | 74/337 [01:30<05:17,  1.21s/it]daily life:  22%|████████████████▋                                                          | 75/337 [01:32<05:32,  1.27s/it]daily life:  23%|████████████████▉                                                          | 76/337 [01:33<05:26,  1.25s/it]daily life:  23%|█████████████████▏                                                         | 77/337 [01:34<05:22,  1.24s/it]daily life:  23%|█████████████████▎                                                         | 78/337 [01:35<05:18,  1.23s/it]daily life:  23%|█████████████████▌                                                         | 79/337 [01:37<05:16,  1.23s/it]daily life:  24%|█████████████████▊                                                         | 80/337 [01:38<05:14,  1.22s/it]daily life:  24%|██████████████████                                                         | 81/337 [01:39<05:11,  1.22s/it]daily life:  24%|██████████████████▏                                                        | 82/337 [01:40<05:09,  1.21s/it]daily life:  25%|██████████████████▍                                                        | 83/337 [01:41<05:08,  1.21s/it]daily life:  25%|██████████████████▋                                                        | 84/337 [01:43<05:06,  1.21s/it]daily life:  25%|██████████████████▉                                                        | 85/337 [01:44<05:04,  1.21s/it]daily life:  26%|███████████████████▏                                                       | 86/337 [01:45<05:04,  1.21s/it]daily life:  26%|███████████████████▎                                                       | 87/337 [01:46<05:03,  1.21s/it]daily life:  26%|███████████████████▌                                                       | 88/337 [01:48<05:01,  1.21s/it]daily life:  26%|███████████████████▊                                                       | 89/337 [01:49<05:00,  1.21s/it]daily life:  27%|████████████████████                                                       | 90/337 [01:50<04:59,  1.21s/it]daily life:  27%|████████████████████▎                                                      | 91/337 [01:51<04:57,  1.21s/it]daily life:  27%|████████████████████▍                                                      | 92/337 [01:52<04:56,  1.21s/it]daily life:  28%|████████████████████▋                                                      | 93/337 [01:54<04:55,  1.21s/it]daily life:  28%|████████████████████▉                                                      | 94/337 [01:55<04:54,  1.21s/it]daily life:  28%|█████████████████████▏                                                     | 95/337 [01:56<04:52,  1.21s/it]daily life:  28%|█████████████████████▎                                                     | 96/337 [01:57<04:50,  1.21s/it]daily life:  29%|█████████████████████▌                                                     | 97/337 [01:58<04:49,  1.21s/it]daily life:  29%|█████████████████████▊                                                     | 98/337 [02:00<04:49,  1.21s/it]daily life:  29%|██████████████████████                                                     | 99/337 [02:01<04:47,  1.21s/it]daily life:  30%|█████████████████████▉                                                    | 100/337 [02:02<04:46,  1.21s/it]daily life:  30%|██████████████████████▏                                                   | 101/337 [02:03<04:45,  1.21s/it]daily life:  30%|██████████████████████▍                                                   | 102/337 [02:04<04:44,  1.21s/it]daily life:  31%|██████████████████████▌                                                   | 103/337 [02:06<04:43,  1.21s/it]daily life:  31%|██████████████████████▊                                                   | 104/337 [02:07<04:42,  1.21s/it]daily life:  31%|███████████████████████                                                   | 105/337 [02:08<04:40,  1.21s/it]daily life:  31%|███████████████████████▎                                                  | 106/337 [02:09<04:39,  1.21s/it]daily life:  32%|███████████████████████▍                                                  | 107/337 [02:11<04:37,  1.21s/it]daily life:  32%|███████████████████████▋                                                  | 108/337 [02:12<04:37,  1.21s/it]daily life:  32%|███████████████████████▉                                                  | 109/337 [02:13<04:35,  1.21s/it]daily life:  33%|████████████████████████▏                                                 | 110/337 [02:14<04:34,  1.21s/it]daily life:  33%|████████████████████████▎                                                 | 111/337 [02:15<04:33,  1.21s/it]daily life:  33%|████████████████████████▌                                                 | 112/337 [02:17<04:32,  1.21s/it]daily life:  34%|████████████████████████▊                                                 | 113/337 [02:18<04:30,  1.21s/it]daily life:  34%|█████████████████████████                                                 | 114/337 [02:19<04:29,  1.21s/it]daily life:  34%|█████████████████████████▎                                                | 115/337 [02:20<04:28,  1.21s/it]daily life:  34%|█████████████████████████▍                                                | 116/337 [02:21<04:26,  1.21s/it]daily life:  35%|█████████████████████████▋                                                | 117/337 [02:23<04:25,  1.21s/it]daily life:  35%|█████████████████████████▉                                                | 118/337 [02:24<04:24,  1.21s/it]daily life:  35%|██████████████████████████▏                                               | 119/337 [02:25<04:23,  1.21s/it]daily life:  36%|██████████████████████████▎                                               | 120/337 [02:26<04:22,  1.21s/it]daily life:  36%|██████████████████████████▌                                               | 121/337 [02:27<04:20,  1.21s/it]daily life:  36%|██████████████████████████▊                                               | 122/337 [02:29<04:19,  1.21s/it]daily life:  36%|███████████████████████████                                               | 123/337 [02:30<04:18,  1.21s/it]daily life:  37%|███████████████████████████▏                                              | 124/337 [02:31<04:17,  1.21s/it]daily life:  37%|███████████████████████████▍                                              | 125/337 [02:32<04:16,  1.21s/it]daily life:  37%|███████████████████████████▋                                              | 126/337 [02:33<04:14,  1.21s/it]daily life:  38%|███████████████████████████▉                                              | 127/337 [02:35<04:13,  1.21s/it]daily life:  38%|████████████████████████████                                              | 128/337 [02:36<04:12,  1.21s/it]daily life:  38%|████████████████████████████▎                                             | 129/337 [02:37<04:11,  1.21s/it]daily life:  39%|████████████████████████████▌                                             | 130/337 [02:38<04:10,  1.21s/it]daily life:  39%|████████████████████████████▊                                             | 131/337 [02:40<04:09,  1.21s/it]daily life:  39%|████████████████████████████▉                                             | 132/337 [02:41<04:07,  1.21s/it]daily life:  39%|█████████████████████████████▏                                            | 133/337 [02:42<04:06,  1.21s/it]daily life:  40%|█████████████████████████████▍                                            | 134/337 [02:43<04:05,  1.21s/it]daily life:  40%|█████████████████████████████▋                                            | 135/337 [02:44<04:04,  1.21s/it]daily life:  40%|█████████████████████████████▊                                            | 136/337 [02:46<04:03,  1.21s/it]daily life:  41%|██████████████████████████████                                            | 137/337 [02:47<04:01,  1.21s/it]daily life:  41%|██████████████████████████████▎                                           | 138/337 [02:48<04:00,  1.21s/it]daily life:  41%|██████████████████████████████▌                                           | 139/337 [02:49<03:59,  1.21s/it]daily life:  42%|██████████████████████████████▋                                           | 140/337 [02:50<03:58,  1.21s/it]daily life:  42%|██████████████████████████████▉                                           | 141/337 [02:52<03:57,  1.21s/it]daily life:  42%|███████████████████████████████▏                                          | 142/337 [02:53<03:55,  1.21s/it]daily life:  42%|███████████████████████████████▍                                          | 143/337 [02:54<03:54,  1.21s/it]daily life:  43%|███████████████████████████████▌                                          | 144/337 [02:55<03:53,  1.21s/it]daily life:  43%|███████████████████████████████▊                                          | 145/337 [02:56<03:52,  1.21s/it]daily life:  43%|████████████████████████████████                                          | 146/337 [02:58<03:51,  1.21s/it]daily life:  44%|████████████████████████████████▎                                         | 147/337 [02:59<03:50,  1.21s/it]daily life:  44%|████████████████████████████████▍                                         | 148/337 [03:00<03:49,  1.21s/it]daily life:  44%|████████████████████████████████▋                                         | 149/337 [03:01<03:47,  1.21s/it]daily life:  45%|████████████████████████████████▉                                         | 150/337 [03:03<03:46,  1.21s/it]daily life:  45%|█████████████████████████████████▏                                        | 151/337 [03:04<03:45,  1.21s/it]daily life:  45%|█████████████████████████████████▍                                        | 152/337 [03:05<03:43,  1.21s/it]daily life:  45%|█████████████████████████████████▌                                        | 153/337 [03:06<03:42,  1.21s/it]daily life:  46%|█████████████████████████████████▊                                        | 154/337 [03:07<03:41,  1.21s/it]daily life:  46%|██████████████████████████████████                                        | 155/337 [03:09<03:40,  1.21s/it]daily life:  46%|██████████████████████████████████▎                                       | 156/337 [03:10<03:39,  1.21s/it]daily life:  47%|██████████████████████████████████▍                                       | 157/337 [03:11<03:37,  1.21s/it]daily life:  47%|██████████████████████████████████▋                                       | 158/337 [03:12<03:36,  1.21s/it]daily life:  47%|██████████████████████████████████▉                                       | 159/337 [03:13<03:35,  1.21s/it]daily life:  47%|███████████████████████████████████▏                                      | 160/337 [03:15<03:34,  1.21s/it]daily life:  48%|███████████████████████████████████▎                                      | 161/337 [03:16<03:33,  1.21s/it]daily life:  48%|███████████████████████████████████▌                                      | 162/337 [03:17<03:32,  1.21s/it]daily life:  48%|███████████████████████████████████▊                                      | 163/337 [03:18<03:30,  1.21s/it]daily life:  49%|████████████████████████████████████                                      | 164/337 [03:19<03:29,  1.21s/it]daily life:  49%|████████████████████████████████████▏                                     | 165/337 [03:21<03:28,  1.21s/it]daily life:  49%|████████████████████████████████████▍                                     | 166/337 [03:22<03:27,  1.21s/it]daily life:  50%|████████████████████████████████████▋                                     | 167/337 [03:23<03:25,  1.21s/it]daily life:  50%|████████████████████████████████████▉                                     | 168/337 [03:24<03:24,  1.21s/it]daily life:  50%|█████████████████████████████████████                                     | 169/337 [03:26<03:23,  1.21s/it]daily life:  50%|█████████████████████████████████████▎                                    | 170/337 [03:27<03:22,  1.21s/it]daily life:  51%|█████████████████████████████████████▌                                    | 171/337 [03:28<03:21,  1.21s/it]daily life:  51%|█████████████████████████████████████▊                                    | 172/337 [03:29<03:19,  1.21s/it]daily life:  51%|█████████████████████████████████████▉                                    | 173/337 [03:30<03:18,  1.21s/it]daily life:  52%|██████████████████████████████████████▏                                   | 174/337 [03:32<03:17,  1.21s/it]daily life:  52%|██████████████████████████████████████▍                                   | 175/337 [03:33<03:16,  1.21s/it]daily life:  52%|██████████████████████████████████████▋                                   | 176/337 [03:34<03:14,  1.21s/it]daily life:  53%|██████████████████████████████████████▊                                   | 177/337 [03:35<03:13,  1.21s/it]daily life:  53%|███████████████████████████████████████                                   | 178/337 [03:36<03:12,  1.21s/it]daily life:  53%|███████████████████████████████████████▎                                  | 179/337 [03:38<03:11,  1.21s/it]daily life:  53%|███████████████████████████████████████▌                                  | 180/337 [03:39<03:09,  1.21s/it]daily life:  54%|███████████████████████████████████████▋                                  | 181/337 [03:40<03:09,  1.21s/it]daily life:  54%|███████████████████████████████████████▉                                  | 182/337 [03:41<03:07,  1.21s/it]daily life:  54%|████████████████████████████████████████▏                                 | 183/337 [03:42<03:06,  1.21s/it]daily life:  55%|████████████████████████████████████████▍                                 | 184/337 [03:44<03:05,  1.21s/it]daily life:  55%|████████████████████████████████████████▌                                 | 185/337 [03:45<03:04,  1.21s/it]daily life:  55%|████████████████████████████████████████▊                                 | 186/337 [03:46<03:02,  1.21s/it]daily life:  55%|█████████████████████████████████████████                                 | 187/337 [03:47<03:01,  1.21s/it]daily life:  56%|█████████████████████████████████████████▎                                | 188/337 [03:49<03:00,  1.21s/it]daily life:  56%|█████████████████████████████████████████▌                                | 189/337 [03:50<02:58,  1.21s/it]daily life:  56%|█████████████████████████████████████████▋                                | 190/337 [03:51<02:57,  1.21s/it]daily life:  57%|█████████████████████████████████████████▉                                | 191/337 [03:52<02:56,  1.21s/it]daily life:  57%|██████████████████████████████████████████▏                               | 192/337 [03:53<02:55,  1.21s/it]daily life:  57%|██████████████████████████████████████████▍                               | 193/337 [03:55<02:54,  1.21s/it]daily life:  58%|██████████████████████████████████████████▌                               | 194/337 [03:56<02:53,  1.21s/it]daily life:  58%|██████████████████████████████████████████▊                               | 195/337 [03:57<02:52,  1.22s/it]daily life:  58%|███████████████████████████████████████████                               | 196/337 [03:58<02:51,  1.22s/it]daily life:  58%|███████████████████████████████████████████▎                              | 197/337 [03:59<02:50,  1.21s/it]daily life:  59%|███████████████████████████████████████████▍                              | 198/337 [04:01<02:48,  1.21s/it]daily life:  59%|███████████████████████████████████████████▋                              | 199/337 [04:02<02:47,  1.22s/it]daily life:  59%|███████████████████████████████████████████▉                              | 200/337 [04:03<02:46,  1.21s/it]daily life:  60%|████████████████████████████████████████████▏                             | 201/337 [04:04<02:45,  1.22s/it]daily life:  60%|████████████████████████████████████████████▎                             | 202/337 [04:06<02:43,  1.21s/it]daily life:  60%|████████████████████████████████████████████▌                             | 203/337 [04:07<02:42,  1.21s/it]daily life:  61%|████████████████████████████████████████████▊                             | 204/337 [04:08<02:41,  1.21s/it]daily life:  61%|█████████████████████████████████████████████                             | 205/337 [04:09<02:39,  1.21s/it]daily life:  61%|█████████████████████████████████████████████▏                            | 206/337 [04:10<02:38,  1.21s/it]daily life:  61%|█████████████████████████████████████████████▍                            | 207/337 [04:12<02:37,  1.21s/it]daily life:  62%|█████████████████████████████████████████████▋                            | 208/337 [04:13<02:36,  1.21s/it]daily life:  62%|█████████████████████████████████████████████▉                            | 209/337 [04:14<02:35,  1.21s/it]daily life:  62%|██████████████████████████████████████████████                            | 210/337 [04:15<02:33,  1.21s/it]daily life:  63%|██████████████████████████████████████████████▎                           | 211/337 [04:16<02:32,  1.21s/it]daily life:  63%|██████████████████████████████████████████████▌                           | 212/337 [04:18<02:30,  1.21s/it]daily life:  63%|██████████████████████████████████████████████▊                           | 213/337 [04:19<02:29,  1.21s/it]daily life:  64%|██████████████████████████████████████████████▉                           | 214/337 [04:20<02:28,  1.21s/it]daily life:  64%|███████████████████████████████████████████████▏                          | 215/337 [04:21<02:27,  1.21s/it]daily life:  64%|███████████████████████████████████████████████▍                          | 216/337 [04:22<02:26,  1.21s/it]daily life:  64%|███████████████████████████████████████████████▋                          | 217/337 [04:24<02:24,  1.21s/it]daily life:  65%|███████████████████████████████████████████████▊                          | 218/337 [04:25<02:23,  1.21s/it]daily life:  65%|████████████████████████████████████████████████                          | 219/337 [04:26<02:22,  1.21s/it]daily life:  65%|████████████████████████████████████████████████▎                         | 220/337 [04:27<02:21,  1.21s/it]daily life:  66%|████████████████████████████████████████████████▌                         | 221/337 [04:28<02:19,  1.21s/it]daily life:  66%|████████████████████████████████████████████████▋                         | 222/337 [04:30<02:18,  1.21s/it]daily life:  66%|████████████████████████████████████████████████▉                         | 223/337 [04:31<02:17,  1.21s/it]daily life:  66%|█████████████████████████████████████████████████▏                        | 224/337 [04:32<02:16,  1.21s/it]daily life:  67%|█████████████████████████████████████████████████▍                        | 225/337 [04:33<02:15,  1.21s/it]daily life:  67%|█████████████████████████████████████████████████▋                        | 226/337 [04:35<02:14,  1.21s/it]daily life:  67%|█████████████████████████████████████████████████▊                        | 227/337 [04:36<02:12,  1.21s/it]daily life:  68%|██████████████████████████████████████████████████                        | 228/337 [04:37<02:12,  1.21s/it]daily life:  68%|██████████████████████████████████████████████████▎                       | 229/337 [04:38<02:10,  1.21s/it]daily life:  68%|██████████████████████████████████████████████████▌                       | 230/337 [04:39<02:09,  1.21s/it]daily life:  69%|██████████████████████████████████████████████████▋                       | 231/337 [04:41<02:08,  1.21s/it]daily life:  69%|██████████████████████████████████████████████████▉                       | 232/337 [04:42<02:06,  1.21s/it]daily life:  69%|███████████████████████████████████████████████████▏                      | 233/337 [04:43<02:05,  1.21s/it]daily life:  69%|███████████████████████████████████████████████████▍                      | 234/337 [04:44<02:04,  1.21s/it]daily life:  70%|███████████████████████████████████████████████████▌                      | 235/337 [04:45<02:03,  1.21s/it]daily life:  70%|███████████████████████████████████████████████████▊                      | 236/337 [04:47<02:02,  1.21s/it]daily life:  70%|████████████████████████████████████████████████████                      | 237/337 [04:48<02:01,  1.21s/it]daily life:  71%|████████████████████████████████████████████████████▎                     | 238/337 [04:49<02:00,  1.21s/it]daily life:  71%|████████████████████████████████████████████████████▍                     | 239/337 [04:50<01:58,  1.21s/it]daily life:  71%|████████████████████████████████████████████████████▋                     | 240/337 [04:51<01:57,  1.21s/it]daily life:  72%|████████████████████████████████████████████████████▉                     | 241/337 [04:53<01:56,  1.21s/it]daily life:  72%|█████████████████████████████████████████████████████▏                    | 242/337 [04:54<01:54,  1.21s/it]daily life:  72%|█████████████████████████████████████████████████████▎                    | 243/337 [04:55<01:53,  1.21s/it]daily life:  72%|█████████████████████████████████████████████████████▌                    | 244/337 [04:56<01:52,  1.21s/it]daily life:  73%|█████████████████████████████████████████████████████▊                    | 245/337 [04:58<01:51,  1.21s/it]daily life:  73%|██████████████████████████████████████████████████████                    | 246/337 [04:59<01:50,  1.21s/it]daily life:  73%|██████████████████████████████████████████████████████▏                   | 247/337 [05:00<01:48,  1.21s/it]daily life:  74%|██████████████████████████████████████████████████████▍                   | 248/337 [05:01<01:47,  1.21s/it]daily life:  74%|██████████████████████████████████████████████████████▋                   | 249/337 [05:02<01:46,  1.21s/it]daily life:  74%|██████████████████████████████████████████████████████▉                   | 250/337 [05:04<01:45,  1.21s/it]daily life:  74%|███████████████████████████████████████████████████████                   | 251/337 [05:05<01:43,  1.21s/it]daily life:  75%|███████████████████████████████████████████████████████▎                  | 252/337 [05:06<01:42,  1.21s/it]daily life:  75%|███████████████████████████████████████████████████████▌                  | 253/337 [05:07<01:41,  1.21s/it]daily life:  75%|███████████████████████████████████████████████████████▊                  | 254/337 [05:08<01:40,  1.21s/it]daily life:  76%|███████████████████████████████████████████████████████▉                  | 255/337 [05:10<01:39,  1.21s/it]daily life:  76%|████████████████████████████████████████████████████████▏                 | 256/337 [05:11<01:38,  1.21s/it]daily life:  76%|████████████████████████████████████████████████████████▍                 | 257/337 [05:12<01:36,  1.21s/it]daily life:  77%|████████████████████████████████████████████████████████▋                 | 258/337 [05:13<01:35,  1.21s/it]daily life:  77%|████████████████████████████████████████████████████████▊                 | 259/337 [05:14<01:34,  1.21s/it]daily life:  77%|█████████████████████████████████████████████████████████                 | 260/337 [05:16<01:33,  1.21s/it]daily life:  77%|█████████████████████████████████████████████████████████▎                | 261/337 [05:17<01:32,  1.21s/it]daily life:  78%|█████████████████████████████████████████████████████████▌                | 262/337 [05:18<01:30,  1.21s/it]daily life:  78%|█████████████████████████████████████████████████████████▊                | 263/337 [05:19<01:29,  1.21s/it]daily life:  78%|█████████████████████████████████████████████████████████▉                | 264/337 [05:21<01:28,  1.21s/it]daily life:  79%|██████████████████████████████████████████████████████████▏               | 265/337 [05:22<01:27,  1.21s/it]daily life:  79%|██████████████████████████████████████████████████████████▍               | 266/337 [05:23<01:26,  1.21s/it]daily life:  79%|██████████████████████████████████████████████████████████▋               | 267/337 [05:24<01:24,  1.21s/it]daily life:  80%|██████████████████████████████████████████████████████████▊               | 268/337 [05:25<01:23,  1.21s/it]daily life:  80%|███████████████████████████████████████████████████████████               | 269/337 [05:27<01:22,  1.21s/it]daily life:  80%|███████████████████████████████████████████████████████████▎              | 270/337 [05:28<01:20,  1.21s/it]daily life:  80%|███████████████████████████████████████████████████████████▌              | 271/337 [05:29<01:19,  1.21s/it]daily life:  81%|███████████████████████████████████████████████████████████▋              | 272/337 [05:30<01:18,  1.21s/it]daily life:  81%|███████████████████████████████████████████████████████████▉              | 273/337 [05:31<01:17,  1.21s/it]daily life:  81%|████████████████████████████████████████████████████████████▏             | 274/337 [05:33<01:16,  1.21s/it]daily life:  82%|████████████████████████████████████████████████████████████▍             | 275/337 [05:34<01:15,  1.21s/it]daily life:  82%|████████████████████████████████████████████████████████████▌             | 276/337 [05:35<01:13,  1.21s/it]daily life:  82%|████████████████████████████████████████████████████████████▊             | 277/337 [05:36<01:12,  1.21s/it]daily life:  82%|█████████████████████████████████████████████████████████████             | 278/337 [05:37<01:11,  1.21s/it]daily life:  83%|█████████████████████████████████████████████████████████████▎            | 279/337 [05:39<01:10,  1.21s/it]daily life:  83%|█████████████████████████████████████████████████████████████▍            | 280/337 [05:40<01:08,  1.21s/it]daily life:  83%|█████████████████████████████████████████████████████████████▋            | 281/337 [05:41<01:07,  1.21s/it]daily life:  84%|█████████████████████████████████████████████████████████████▉            | 282/337 [05:42<01:06,  1.21s/it]daily life:  84%|██████████████████████████████████████████████████████████████▏           | 283/337 [05:44<01:05,  1.21s/it]daily life:  84%|██████████████████████████████████████████████████████████████▎           | 284/337 [05:45<01:03,  1.21s/it]daily life:  85%|██████████████████████████████████████████████████████████████▌           | 285/337 [05:46<01:02,  1.21s/it]daily life:  85%|██████████████████████████████████████████████████████████████▊           | 286/337 [05:47<01:01,  1.21s/it]daily life:  85%|███████████████████████████████████████████████████████████████           | 287/337 [05:48<01:00,  1.21s/it]daily life:  85%|███████████████████████████████████████████████████████████████▏          | 288/337 [05:50<00:59,  1.21s/it]daily life:  86%|███████████████████████████████████████████████████████████████▍          | 289/337 [05:51<00:57,  1.21s/it]daily life:  86%|███████████████████████████████████████████████████████████████▋          | 290/337 [05:52<00:56,  1.21s/it]daily life:  86%|███████████████████████████████████████████████████████████████▉          | 291/337 [05:53<00:55,  1.21s/it]daily life:  87%|████████████████████████████████████████████████████████████████          | 292/337 [05:54<00:54,  1.21s/it]daily life:  87%|████████████████████████████████████████████████████████████████▎         | 293/337 [05:56<00:53,  1.21s/it]daily life:  87%|████████████████████████████████████████████████████████████████▌         | 294/337 [05:57<00:51,  1.21s/it]daily life:  88%|████████████████████████████████████████████████████████████████▊         | 295/337 [05:58<00:50,  1.21s/it]daily life:  88%|████████████████████████████████████████████████████████████████▉         | 296/337 [05:59<00:49,  1.21s/it]daily life:  88%|█████████████████████████████████████████████████████████████████▏        | 297/337 [06:00<00:48,  1.21s/it]daily life:  88%|█████████████████████████████████████████████████████████████████▍        | 298/337 [06:02<00:47,  1.21s/it]daily life:  89%|█████████████████████████████████████████████████████████████████▋        | 299/337 [06:03<00:46,  1.21s/it]daily life:  89%|█████████████████████████████████████████████████████████████████▉        | 300/337 [06:04<00:44,  1.21s/it]daily life:  89%|██████████████████████████████████████████████████████████████████        | 301/337 [06:05<00:43,  1.21s/it]daily life:  90%|██████████████████████████████████████████████████████████████████▎       | 302/337 [06:06<00:42,  1.21s/it]daily life:  90%|██████████████████████████████████████████████████████████████████▌       | 303/337 [06:08<00:41,  1.21s/it]daily life:  90%|██████████████████████████████████████████████████████████████████▊       | 304/337 [06:09<00:39,  1.21s/it]daily life:  91%|██████████████████████████████████████████████████████████████████▉       | 305/337 [06:10<00:38,  1.21s/it]daily life:  91%|███████████████████████████████████████████████████████████████████▏      | 306/337 [06:11<00:37,  1.21s/it]daily life:  91%|███████████████████████████████████████████████████████████████████▍      | 307/337 [06:13<00:36,  1.21s/it]daily life:  91%|███████████████████████████████████████████████████████████████████▋      | 308/337 [06:14<00:35,  1.21s/it]daily life:  92%|███████████████████████████████████████████████████████████████████▊      | 309/337 [06:15<00:33,  1.21s/it]daily life:  92%|████████████████████████████████████████████████████████████████████      | 310/337 [06:16<00:32,  1.21s/it]daily life:  92%|████████████████████████████████████████████████████████████████████▎     | 311/337 [06:17<00:31,  1.21s/it]daily life:  93%|████████████████████████████████████████████████████████████████████▌     | 312/337 [06:19<00:30,  1.21s/it]daily life:  93%|████████████████████████████████████████████████████████████████████▋     | 313/337 [06:20<00:29,  1.21s/it]daily life:  93%|████████████████████████████████████████████████████████████████████▉     | 314/337 [06:21<00:27,  1.21s/it]daily life:  93%|█████████████████████████████████████████████████████████████████████▏    | 315/337 [06:22<00:26,  1.21s/it]daily life:  94%|█████████████████████████████████████████████████████████████████████▍    | 316/337 [06:23<00:25,  1.21s/it]daily life:  94%|█████████████████████████████████████████████████████████████████████▌    | 317/337 [06:25<00:24,  1.21s/it]daily life:  94%|█████████████████████████████████████████████████████████████████████▊    | 318/337 [06:26<00:22,  1.21s/it]daily life:  95%|██████████████████████████████████████████████████████████████████████    | 319/337 [06:27<00:21,  1.21s/it]daily life:  95%|██████████████████████████████████████████████████████████████████████▎   | 320/337 [06:28<00:20,  1.21s/it]daily life:  95%|██████████████████████████████████████████████████████████████████████▍   | 321/337 [06:29<00:19,  1.21s/it]daily life:  96%|██████████████████████████████████████████████████████████████████████▋   | 322/337 [06:31<00:18,  1.21s/it]daily life:  96%|██████████████████████████████████████████████████████████████████████▉   | 323/337 [06:32<00:16,  1.21s/it]daily life:  96%|███████████████████████████████████████████████████████████████████████▏  | 324/337 [06:33<00:15,  1.21s/it]daily life:  96%|███████████████████████████████████████████████████████████████████████▎  | 325/337 [06:34<00:14,  1.21s/it]daily life:  97%|███████████████████████████████████████████████████████████████████████▌  | 326/337 [06:36<00:13,  1.21s/it]daily life:  97%|███████████████████████████████████████████████████████████████████████▊  | 327/337 [06:37<00:12,  1.21s/it]daily life:  97%|████████████████████████████████████████████████████████████████████████  | 328/337 [06:38<00:10,  1.21s/it]daily life:  98%|████████████████████████████████████████████████████████████████████████▏ | 329/337 [06:39<00:09,  1.22s/it]daily life:  98%|████████████████████████████████████████████████████████████████████████▍ | 330/337 [06:40<00:08,  1.21s/it]daily life:  98%|████████████████████████████████████████████████████████████████████████▋ | 331/337 [06:42<00:07,  1.21s/it]daily life:  99%|████████████████████████████████████████████████████████████████████████▉ | 332/337 [06:43<00:06,  1.21s/it]daily life:  99%|█████████████████████████████████████████████████████████████████████████ | 333/337 [06:44<00:04,  1.21s/it]daily life:  99%|█████████████████████████████████████████████████████████████████████████▎| 334/337 [06:45<00:03,  1.21s/it]daily life:  99%|█████████████████████████████████████████████████████████████████████████▌| 335/337 [06:46<00:02,  1.21s/it]daily life: 100%|█████████████████████████████████████████████████████████████████████████▊| 336/337 [06:48<00:01,  1.21s/it]daily life: 100%|██████████████████████████████████████████████████████████████████████████| 337/337 [06:49<00:00,  1.21s/it]daily life: 100%|██████████████████████████████████████████████████████████████████████████| 337/337 [06:49<00:00,  1.21s/it]
╭─────────────────────────────── Traceback (most recent call last) ────────────────────────────────╮
│ /home/yufei/arabic/LLM-eval-pipeline/eval.py:25 in <module>                                      │
│                                                                                                  │
│   22 │   │   │   │   │     setting=args.setting,                                                 │
│   23 │   │   │   │   │     n_shot=args.n_shot,                                                   │
│   24 │   │   │   │   │     accelerator=accelerator)                                              │
│ ❱ 25 │   Eval.evaluate()                                                                         │
│   26                                                                                             │
│   27                                                                                             │
│   28                                                                                             │
│                                                                                                  │
│ /home/yufei/arabic/LLM-eval-pipeline/benchmark_eval/evaluation.py:215 in evaluate                │
│                                                                                                  │
│   212 │   def evaluate(self):                                                                    │
│   213 │   │   all_datasets = self.benchmark.get_datasets(self.setting, self.n_shot)              │
│   214 │   │   lens = self._count_examples(all_datasets)                                          │
│ ❱ 215 │   │   metrics = self._eval_datasets(all_datasets, save_responses=True)                   │
│   216 │   │   aggr_metrics = self._aggregate_metrics(metrics, lens)                              │
│   217 │   │   if self.accelerator.is_main_process:                                               │
│   218 │   │   │   self.save_aggr_metrics(aggr_metrics)                                           │
│                                                                                                  │
│ /home/yufei/arabic/LLM-eval-pipeline/benchmark_eval/evaluation.py:207 in _eval_datasets          │
│                                                                                                  │
│   204 │   │   │   │   │   │   }                                                                  │
│   205 │   │   │   │   }                                                                          │
│   206 │   │   """                                                                                │
│ ❱ 207 │   │   return {                                                                           │
│   208 │   │   │   task_name: self._eval_task(task_name, all_datasets[task_name], save_response   │
│   209 │   │   │   for task_name in all_datasets.keys()                                           │
│   210 │   │   }                                                                                  │
│                                                                                                  │
│ /home/yufei/arabic/LLM-eval-pipeline/benchmark_eval/evaluation.py:208 in <dictcomp>              │
│                                                                                                  │
│   205 │   │   │   │   }                                                                          │
│   206 │   │   """                                                                                │
│   207 │   │   return {                                                                           │
│ ❱ 208 │   │   │   task_name: self._eval_task(task_name, all_datasets[task_name], save_response   │
│   209 │   │   │   for task_name in all_datasets.keys()                                           │
│   210 │   │   }                                                                                  │
│   211                                                                                            │
│                                                                                                  │
│ /home/yufei/arabic/LLM-eval-pipeline/benchmark_eval/evaluation.py:184 in _eval_task              │
│                                                                                                  │
│   181 │   │                                                                                      │
│   182 │   │   samples = self._zip_qra(dataset, response_list, response_answer_list)              │
│   183 │   │   if save_responses and self.accelerator.is_main_process:                            │
│ ❱ 184 │   │   │   self.save_response(samples, task_name)                                         │
│   185 │   │                                                                                      │
│   186 │   │   metrics = self._compute_metrics(samples, task_name)                                │
│   187 │   │   self.accelerator.print(metrics)                                                    │
│                                                                                                  │
│ /home/yufei/arabic/LLM-eval-pipeline/benchmark_eval/evaluation.py:135 in save_response           │
│                                                                                                  │
│   132 │   │   assert isinstance(task_name, str) and (isinstance(samples, list) and isinstance(   │
│   133 │   │                                                                                      │
│   134 │   │   save_file = os.path.join(self.model_results_dir, f'{task_name}.jsonl')             │
│ ❱ 135 │   │   os.makedirs(os.path.dirname(save_file), exist_ok=True)                             │
│   136 │   │   with open(save_file, 'w', encoding='utf-8') as f:                                  │
│   137 │   │   │   f.writelines([json.dumps(sample, ensure_ascii=False) + '\n'  for sample in s   │
│   138 │   │   print(f'Save responses to {save_file}')                                            │
│                                                                                                  │
│ /mntcephfs/data/med/miniconda3/envs/steven/lib/python3.9/os.py:225 in makedirs                   │
│                                                                                                  │
│    222 │   │   if tail == cdir:           # xxx/newdir/. exists if xxx/newdir exists             │
│    223 │   │   │   return                                                                        │
│    224 │   try:                                                                                  │
│ ❱  225 │   │   mkdir(name, mode)                                                                 │
│    226 │   except OSError:                                                                       │
│    227 │   │   # Cannot rely on checking for EEXIST, since the operating system                  │
│    228 │   │   # could give priority to other errors like EACCES or EROFS                        │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
PermissionError: [Errno 13] Permission denied: 
'benchmark_eval/results/ArabicCulture/llama13b-SRIBD-pretrained-raw-check0-227566'
╭─────────────────────────────── Traceback (most recent call last) ────────────────────────────────╮
│ /mntcephfs/data/med/miniconda3/envs/steven/bin/accelerate:8 in <module>                          │
│                                                                                                  │
│   5 from accelerate.commands.accelerate_cli import main                                          │
│   6 if __name__ == '__main__':                                                                   │
│   7 │   sys.argv[0] = re.sub(r'(-script\.pyw|\.exe)?$', '', sys.argv[0])                         │
│ ❱ 8 │   sys.exit(main())                                                                         │
│   9                                                                                              │
│                                                                                                  │
│ /home/chenjunying/.local/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py:45 in │
│ main                                                                                             │
│                                                                                                  │
│   42 │   │   exit(1)                                                                             │
│   43 │                                                                                           │
│   44 │   # Run                                                                                   │
│ ❱ 45 │   args.func(args)                                                                         │
│   46                                                                                             │
│   47                                                                                             │
│   48 if __name__ == "__main__":                                                                  │
│                                                                                                  │
│ /home/chenjunying/.local/lib/python3.9/site-packages/accelerate/commands/launch.py:918 in        │
│ launch_command                                                                                   │
│                                                                                                  │
│   915 │   elif defaults is not None and defaults.compute_environment == ComputeEnvironment.AMA   │
│   916 │   │   sagemaker_launcher(defaults, args)                                                 │
│   917 │   else:                                                                                  │
│ ❱ 918 │   │   simple_launcher(args)                                                              │
│   919                                                                                            │
│   920                                                                                            │
│   921 def main():                                                                                │
│                                                                                                  │
│ /home/chenjunying/.local/lib/python3.9/site-packages/accelerate/commands/launch.py:580 in        │
│ simple_launcher                                                                                  │
│                                                                                                  │
│   577 │   process.wait()                                                                         │
│   578 │   if process.returncode != 0:                                                            │
│   579 │   │   if not args.quiet:                                                                 │
│ ❱ 580 │   │   │   raise subprocess.CalledProcessError(returncode=process.returncode, cmd=cmd)    │
│   581 │   │   else:                                                                              │
│   582 │   │   │   sys.exit(1)                                                                    │
│   583                                                                                            │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
CalledProcessError: Command '['/mntcephfs/data/med/miniconda3/envs/steven/bin/python', 'eval.py', '--model_id', 
'llama13b-SRIBD-pretrained-raw-check0-227566', '--batch_size', '1', '--benchmark_name', 'ArabicCulture', '--setting', 
'few_shot', '--n_shot', '5', '--generation_type', 'ArabicCulture']' returned non-zero exit status 1.
[2023-09-11 22:37:01,722] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[22:37:04] WARNING  The following values were not passed to `accelerate launch` and had defaults used instead:   launch.py:890
                            `--num_processes` was set to a value of `1`                                                       
                            `--num_machines` was set to a value of `1`                                                        
                            `--mixed_precision` was set to a value of `'no'`                                                  
                            `--dynamo_backend` was set to a value of `'no'`                                                   
                    To avoid this warning pass in values for each of the problematic parameters or run                        
                    `accelerate config`.                                                                                      
[2023-09-11 22:37:06,033] [INFO] [real_accelerator.py:133:get_accelerator] Setting ds_accelerator to cuda (auto detect)
Loading checkpoint shards:   0%|                                                                       | 0/6 [00:00<?, ?it/s]Loading checkpoint shards:  17%|██████████▌                                                    | 1/6 [00:05<00:28,  5.62s/it]Loading checkpoint shards:  33%|█████████████████████                                          | 2/6 [00:12<00:24,  6.11s/it]Loading checkpoint shards:  50%|███████████████████████████████▌                               | 3/6 [00:18<00:18,  6.31s/it]Loading checkpoint shards:  67%|██████████████████████████████████████████                     | 4/6 [00:24<00:12,  6.25s/it]Loading checkpoint shards:  83%|████████████████████████████████████████████████████▌          | 5/6 [00:31<00:06,  6.45s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████| 6/6 [00:34<00:00,  5.38s/it]Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████| 6/6 [00:34<00:00,  5.81s/it]
╭─────────────────────────────── Traceback (most recent call last) ────────────────────────────────╮
│ /home/yufei/arabic/LLM-eval-pipeline/eval.py:17 in <module>                                      │
│                                                                                                  │
│   14 │   args = parser.parse_args()                                                              │
│   15 │                                                                                           │
│   16 │   accelerator = Accelerator()                                                             │
│ ❱ 17 │   agent = Agent.from_model_id(args.model_id, generation_type=args.generation_type, acc    │
│   18 │                                                                                           │
│   19 │   eval_class = benchmark2class[args.benchmark_name]                                       │
│   20 │   Eval = eval_class(agent=agent,                                                          │
│                                                                                                  │
│ /home/yufei/arabic/LLM-eval-pipeline/utils/models.py:55 in from_model_id                         │
│                                                                                                  │
│    52 │   │   model, tokenizer = load_model_and_tokenizer(model_id)                              │
│    53 │   │   system_prompt = load_system_prompt(model_id)                                       │
│    54 │   │   gconfig = load_gconfig(generation_type=generation_type)                            │
│ ❱  55 │   │   return cls(                                                                        │
│    56 │   │   │   model_id=model_id,                                                             │
│    57 │   │   │   model=model,                                                                   │
│    58 │   │   │   tokenizer=tokenizer,                                                           │
│                                                                                                  │
│ /home/yufei/arabic/LLM-eval-pipeline/utils/models.py:42 in __init__                              │
│                                                                                                  │
│    39 │   │   self.pad_token_id = self.tokenizer.pad_token_id                                    │
│    40 │   │   self.collate_fn = transformers.DataCollatorForSeq2Seq(self.tokenizer, return_ten   │
│    41 │   │                                                                                      │
│ ❱  42 │   │   self.model = self.accelerator.prepare_model(self.model)                            │
│    43 │   │   self.model.eval()                                                                  │
│    44 │                                                                                          │
│    45 │   @classmethod                                                                           │
│                                                                                                  │
│ /home/chenjunying/.local/lib/python3.9/site-packages/accelerate/accelerator.py:1218 in           │
│ prepare_model                                                                                    │
│                                                                                                  │
│   1215 │   │   │   │   │   "You can't train a model that has been loaded in 8-bit precision wit  │
│   1216 │   │   │   │   )                                                                         │
│   1217 │   │   elif device_placement and not has_hf_device_map:                                  │
│ ❱ 1218 │   │   │   model = model.to(self.device)                                                 │
│   1219 │   │                                                                                     │
│   1220 │   │   if self.distributed_type == DistributedType.MULTI_GPU:                            │
│   1221 │   │   │   if any(p.requires_grad for p in model.parameters()):                          │
│                                                                                                  │
│ /home/chenjunying/.local/lib/python3.9/site-packages/transformers/modeling_utils.py:1902 in to   │
│                                                                                                  │
│   1899 │   │   │   │   " model has already been set to the correct devices and casted to the co  │
│   1900 │   │   │   )                                                                             │
│   1901 │   │   else:                                                                             │
│ ❱ 1902 │   │   │   return super().to(*args, **kwargs)                                            │
│   1903 │                                                                                         │
│   1904 │   def half(self, *args):                                                                │
│   1905 │   │   # Checks if the model has been loaded in 8-bit                                    │
│                                                                                                  │
│ /mntcephfs/data/med/miniconda3/envs/steven/lib/python3.9/site-packages/torch/nn/modules/module.p │
│ y:989 in to                                                                                      │
│                                                                                                  │
│    986 │   │   │   │   │   │   │   non_blocking, memory_format=convert_to_format)                │
│    987 │   │   │   return t.to(device, dtype if t.is_floating_point() or t.is_complex() else No  │
│    988 │   │                                                                                     │
│ ❱  989 │   │   return self._apply(convert)                                                       │
│    990 │                                                                                         │
│    991 │   def register_backward_hook(                                                           │
│    992 │   │   self, hook: Callable[['Module', _grad_t, _grad_t], Union[None, Tensor]]           │
│                                                                                                  │
│ /mntcephfs/data/med/miniconda3/envs/steven/lib/python3.9/site-packages/torch/nn/modules/module.p │
│ y:641 in _apply                                                                                  │
│                                                                                                  │
│    638 │                                                                                         │
│    639 │   def _apply(self, fn):                                                                 │
│    640 │   │   for module in self.children():                                                    │
│ ❱  641 │   │   │   module._apply(fn)                                                             │
│    642 │   │                                                                                     │
│    643 │   │   def compute_should_use_set_data(tensor, tensor_applied):                          │
│    644 │   │   │   if torch._has_compatible_shallow_copy_type(tensor, tensor_applied):           │
│                                                                                                  │
│ /mntcephfs/data/med/miniconda3/envs/steven/lib/python3.9/site-packages/torch/nn/modules/module.p │
│ y:641 in _apply                                                                                  │
│                                                                                                  │
│    638 │                                                                                         │
│    639 │   def _apply(self, fn):                                                                 │
│    640 │   │   for module in self.children():                                                    │
│ ❱  641 │   │   │   module._apply(fn)                                                             │
│    642 │   │                                                                                     │
│    643 │   │   def compute_should_use_set_data(tensor, tensor_applied):                          │
│    644 │   │   │   if torch._has_compatible_shallow_copy_type(tensor, tensor_applied):           │
│                                                                                                  │
│ /mntcephfs/data/med/miniconda3/envs/steven/lib/python3.9/site-packages/torch/nn/modules/module.p │
│ y:641 in _apply                                                                                  │
│                                                                                                  │
│    638 │                                                                                         │
│    639 │   def _apply(self, fn):                                                                 │
│    640 │   │   for module in self.children():                                                    │
│ ❱  641 │   │   │   module._apply(fn)                                                             │
│    642 │   │                                                                                     │
│    643 │   │   def compute_should_use_set_data(tensor, tensor_applied):                          │
│    644 │   │   │   if torch._has_compatible_shallow_copy_type(tensor, tensor_applied):           │
│                                                                                                  │
│ /mntcephfs/data/med/miniconda3/envs/steven/lib/python3.9/site-packages/torch/nn/modules/module.p │
│ y:641 in _apply                                                                                  │
│                                                                                                  │
│    638 │                                                                                         │
│    639 │   def _apply(self, fn):                                                                 │
│    640 │   │   for module in self.children():                                                    │
│ ❱  641 │   │   │   module._apply(fn)                                                             │
│    642 │   │                                                                                     │
│    643 │   │   def compute_should_use_set_data(tensor, tensor_applied):                          │
│    644 │   │   │   if torch._has_compatible_shallow_copy_type(tensor, tensor_applied):           │
│                                                                                                  │
│ /mntcephfs/data/med/miniconda3/envs/steven/lib/python3.9/site-packages/torch/nn/modules/module.p │
│ y:641 in _apply                                                                                  │
│                                                                                                  │
│    638 │                                                                                         │
│    639 │   def _apply(self, fn):                                                                 │
│    640 │   │   for module in self.children():                                                    │
│ ❱  641 │   │   │   module._apply(fn)                                                             │
│    642 │   │                                                                                     │
│    643 │   │   def compute_should_use_set_data(tensor, tensor_applied):                          │
│    644 │   │   │   if torch._has_compatible_shallow_copy_type(tensor, tensor_applied):           │
│                                                                                                  │
│ /mntcephfs/data/med/miniconda3/envs/steven/lib/python3.9/site-packages/torch/nn/modules/module.p │
│ y:664 in _apply                                                                                  │
│                                                                                                  │
│    661 │   │   │   # track autograd history of `param_applied`, so we have to use                │
│    662 │   │   │   # `with torch.no_grad():`                                                     │
│    663 │   │   │   with torch.no_grad():                                                         │
│ ❱  664 │   │   │   │   param_applied = fn(param)                                                 │
│    665 │   │   │   should_use_set_data = compute_should_use_set_data(param, param_applied)       │
│    666 │   │   │   if should_use_set_data:                                                       │
│    667 │   │   │   │   param.data = param_applied                                                │
│                                                                                                  │
│ /mntcephfs/data/med/miniconda3/envs/steven/lib/python3.9/site-packages/torch/nn/modules/module.p │
│ y:987 in convert                                                                                 │
│                                                                                                  │
│    984 │   │   │   if convert_to_format is not None and t.dim() in (4, 5):                       │
│    985 │   │   │   │   return t.to(device, dtype if t.is_floating_point() or t.is_complex() els  │
│    986 │   │   │   │   │   │   │   non_blocking, memory_format=convert_to_format)                │
│ ❱  987 │   │   │   return t.to(device, dtype if t.is_floating_point() or t.is_complex() else No  │
│    988 │   │                                                                                     │
│    989 │   │   return self._apply(convert)                                                       │
│    990                                                                                           │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
OutOfMemoryError: CUDA out of memory. Tried to allocate 268.00 MiB (GPU 0; 31.74 GiB total capacity; 30.76 GiB already 
allocated; 142.88 MiB free; 30.86 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting 
max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
╭─────────────────────────────── Traceback (most recent call last) ────────────────────────────────╮
│ /mntcephfs/data/med/miniconda3/envs/steven/bin/accelerate:8 in <module>                          │
│                                                                                                  │
│   5 from accelerate.commands.accelerate_cli import main                                          │
│   6 if __name__ == '__main__':                                                                   │
│   7 │   sys.argv[0] = re.sub(r'(-script\.pyw|\.exe)?$', '', sys.argv[0])                         │
│ ❱ 8 │   sys.exit(main())                                                                         │
│   9                                                                                              │
│                                                                                                  │
│ /home/chenjunying/.local/lib/python3.9/site-packages/accelerate/commands/accelerate_cli.py:45 in │
│ main                                                                                             │
│                                                                                                  │
│   42 │   │   exit(1)                                                                             │
│   43 │                                                                                           │
│   44 │   # Run                                                                                   │
│ ❱ 45 │   args.func(args)                                                                         │
│   46                                                                                             │
│   47                                                                                             │
│   48 if __name__ == "__main__":                                                                  │
│                                                                                                  │
│ /home/chenjunying/.local/lib/python3.9/site-packages/accelerate/commands/launch.py:918 in        │
│ launch_command                                                                                   │
│                                                                                                  │
│   915 │   elif defaults is not None and defaults.compute_environment == ComputeEnvironment.AMA   │
│   916 │   │   sagemaker_launcher(defaults, args)                                                 │
│   917 │   else:                                                                                  │
│ ❱ 918 │   │   simple_launcher(args)                                                              │
│   919                                                                                            │
│   920                                                                                            │
│   921 def main():                                                                                │
│                                                                                                  │
│ /home/chenjunying/.local/lib/python3.9/site-packages/accelerate/commands/launch.py:580 in        │
│ simple_launcher                                                                                  │
│                                                                                                  │
│   577 │   process.wait()                                                                         │
│   578 │   if process.returncode != 0:                                                            │
│   579 │   │   if not args.quiet:                                                                 │
│ ❱ 580 │   │   │   raise subprocess.CalledProcessError(returncode=process.returncode, cmd=cmd)    │
│   581 │   │   else:                                                                              │
│   582 │   │   │   sys.exit(1)                                                                    │
│   583                                                                                            │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
CalledProcessError: Command '['/mntcephfs/data/med/miniconda3/envs/steven/bin/python', 'eval.py', '--model_id', 'jais-13b', 
'--batch_size', '1', '--benchmark_name', 'ArabicCulture', '--setting', 'few_shot', '--n_shot', '5', '--generation_type', 
'ArabicCulture']' returned non-zero exit status 1.
